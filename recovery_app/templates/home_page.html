{% extends 'base.html' %}
{% load static wagtailcore_tags %}
{% load cache %}

{% block title %}Dynamix Recovery - Professional Car Towing & Roadside Assistance in Northampton{% endblock %}

{% block og_title %}Dynamix Recovery - Professional Car Towing & Roadside Assistance in Northampton{% endblock %}

{% block twitter_title %}Dynamix Recovery - Professional Car Towing & Roadside Assistance in Northampton{% endblock %}

{% block meta_description %}
<meta name="description" content="Dynamix Recovery provides 24/7 professional car towing and roadside assistance in Northampton. Fast, reliable service covering Rugby, Towcester, Wellingborough and surrounding areas. Call now for emergency help!">
<meta name="keywords" content="car towing Northampton, roadside assistance, emergency towing, breakdown recovery, 24/7 towing service, vehicle recovery Northampton, tow truck service">
{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'recovery_app/css/animated-order-button.css' %}">
    <link rel="stylesheet" href="{% static 'recovery_app/css/main.css' %}">
{% endblock %}

{% block content %}
<!-- Structured Data JSON-LD -->
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "LocalBusiness",
    "name": "Dynamix Recovery",
    "image": "{% static 'recovery_app/images/logo.png' %}",
    "description": "Professional 24/7 car towing and roadside assistance service in Northampton and surrounding areas.",
    "url": "{{ request.build_absolute_uri }}",
    "telephone": "{{ whatsapp_number }}",
    "email": "support@dinamix.com",
    "address": {
        "@type": "PostalAddress",
        "addressLocality": "Northampton",
        "addressRegion": "Northamptonshire",
        "addressCountry": "UK"
    },
    "geo": {
        "@type": "GeoCoordinates",
        "latitude": "52.2405",
        "longitude": "-0.9027"
    },
    "openingHours": "Mo-Su 00:00-23:59",
    "serviceArea": {
        "@type": "Place",
        "name": "Northamptonshire and surrounding areas"
    },
    "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Towing Services",
        "itemListElement": [
            {
                "@type": "Offer",
                "itemOffered": {
                    "@type": "Service",
                    "name": "Car Towing",
                    "description": "Professional passenger car towing service"
                }
            },
            {
                "@type": "Offer",
                "itemOffered": {
                    "@type": "Service",
                    "name": "Roadside Assistance",
                    "description": "Emergency roadside assistance including jump starts and tire changes"
                }
            },
            {
                "@type": "Offer",
                "itemOffered": {
                    "@type": "Service",
                    "name": "Fuel Delivery",
                    "description": "Emergency fuel delivery service"
                }
            }
        ]
    },
    "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "{{ average_rating|default:'4.8' }}",
        "reviewCount": "{{ total_reviews|default:'127' }}"
    }
}
</script>

<!-- Главный слайдер с героем -->
<section class="relative w-full hero-section overflow-hidden" style="height: 600px;">
    <!-- Слайдер как фон -->
    <div class="absolute inset-0 z-0">
        {% cache 259200 "hero_slider" page.video.file.url page.video_mobile.file.url|default:0 %}
        {% include 'includes/animated_slider.html' %}
        {% endcache %}
    </div>
    
    <!-- Оверлей и контент поверх слайдера -->
    <div class="absolute inset-0 bg-black bg-opacity-30 z-10"></div>
    <div class="absolute inset-0 z-20 container mx-auto px-4 h-full flex flex-col text-center text-white">
        <div class="flex-1 flex flex-col justify-center">
            <div class="mb-6 animate-fade-in">
                <h2 class="text-2xl md:text-3xl hero-subtitle mb-2">WELCOME TO</h2>
                <h1 class="text-7xl md:text-9xl font-black mb-2 hero-logo-main">DYNAMIX</h1>
                <h2 class="text-2xl md:text-3xl hero-subtitle">QUICK RECOVERY!</h2>
            </div>
        </div>
        <div class="pb-8">
            <a href="{% url 'recovery_app:contact' %}"
               class="hero-button inline-block bg-white text-blue-600 px-10 py-4 rounded-full font-bold text-lg btn-hover-effect animate-fade-in"
               style="animation-delay: 0.4s;">
               Emergency Call 24/7
            </a>
        </div>
    </div>
</section>

{% cache 86400 "services_section" %}  {# 1 day cache #}
<section class="container mx-auto px-4 mb-12 animate-on-scroll">
    <h2 class="text-3xl font-bold text-center mb-8">Our Services</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div class="bg-white p-6 rounded-lg shadow-md card-hover">
            <i class="fas fa-truck text-4xl text-blue-600 mb-4"></i>
            <h3 class="text-xl font-bold mb-2">Passenger Car Towing</h3>
            <p class="text-gray-600">Fast and careful transportation of your vehicle</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md card-hover">
            <i class="fas fa-car text-4xl text-blue-600 mb-4"></i>
            <h3 class="text-xl font-bold mb-2">Technical Assistance</h3>
            <p class="text-gray-600">Engine start, tire replacement, fluid top-up</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md card-hover">
            <i class="fas fa-tools text-4xl text-blue-600 mb-4"></i>
            <h3 class="text-xl font-bold mb-2">Fuel Delivery</h3>
            <p class="text-gray-600">Urgent fuel delivery to the breakdown location</p>
        </div>
    </div>
</section>
{% endcache %}

<section class="bg-gray-100 py-12 rounded-lg mb-12 animate-on-scroll">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
            <div>
                <div class="text-4xl font-bold text-blue-600 mb-2 js-count" data-target="{{ average_rating|default:'4.8' }}" data-postfix="">{{ average_rating|default:"4.8" }}</div>
                <p class="text-gray-600">Average Rating</p>
            </div>
            <div>
                <div class="text-4xl font-bold text-blue-600 mb-2 js-count" data-target="{{ total_reviews|default:'127' }}" data-postfix="">{{ total_reviews|default:"127" }}</div>
                <p class="text-gray-600">Customer Reviews</p>
            </div>
            <div>
                <div class="text-4xl font-bold text-blue-600 mb-2 js-count" data-target="{{ total_services|default:'1000' }}" data-postfix="+">{{ total_services|default:"1000+" }}</div>
                <p class="text-gray-600">Completed Towings</p>
            </div>
        </div>
    </div>
</section>

{% cache 86400 "work_photos" %}  {# 1 day cache #}
<section class="container mx-auto px-4 mb-12 animate-on-scroll">
    <h2 class="text-3xl font-bold text-center mb-8">Our Completed Work</h2>
    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 work-photo-grid auto-rows-min">
        {% load wagtailimages_tags %}
        {% for photo in work_photos %}
        <div class="work-photo-card bg-white rounded-lg shadow-md overflow-hidden relative
                    {% if forloop.counter0 == 0 %} col-span-2 row-span-2
                    {% elif forloop.counter0 == 2 %} col-span-2 row-span-1
                    {% elif forloop.counter0 == 4 %} col-span-1 row-span-2
                    {% else %} col-span-1 row-span-1 {% endif %}">
            {% if photo.image %}
            {% image photo.image fill-400x300 as photo_img %}
            <img src="{{ photo_img.url }}" alt="{{ photo.title }}"
                 class="w-full h-full object-cover transition-transform duration-300">
            <div class="absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-50 transition-opacity duration-300 flex items-center justify-center opacity-0 hover:opacity-100">
                <div class="text-white text-center p-4">
                    <h3 class="text-lg font-bold">{{ photo.title }}</h3>
                    <p class="text-sm">{{ photo.description|truncatewords:15 }}</p>
                </div>
            </div>
            {% else %}
            <div class="w-full h-full bg-gray-200 flex items-center justify-center rounded-lg">
                <p class="text-gray-500">Image not available</p>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</section>
{% endcache %}

<section class="container mx-auto px-4 mb-12 animate-on-scroll">
    <h2 class="text-3xl font-bold text-center mb-8">Our Customer Reviews</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {% for review in reviews %}
        <div class="bg-white p-6 rounded-lg shadow-md card-hover">
            <div class="flex items-center mb-4">
                <div class="text-yellow-400">
                    {% for i in "12345"|make_list %}
                        {% if forloop.counter <= review.rating %}
                            <i class="fas fa-star rating-star"></i>
                        {% else %}
                            <i class="far fa-star rating-star"></i>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            <p class="text-gray-600 mb-4">{{ review.text }}</p>
            <div class="font-bold">{{ review.name }}</div>
            <div class="text-sm text-gray-500">{{ review.created_at|date:"d.m.Y" }}</div>
        </div>
        {% endfor %}
    </div>
    <div class="text-center mt-8">
        <a href="{% url 'recovery_app:reviews' %}" class="text-blue-600 hover:text-blue-800">All Reviews →</a>
    </div>
</section>

<section class="container mx-auto px-4 bg-white p-8 rounded-lg shadow-md animate-on-scroll">
    {% include 'includes/contact_form.html' %}
</section>
{% endblock %}

{% block extra_js %}
    <script src="{% static 'recovery_app/js/animated-order-button.js' %}"></script>
    <script src="{% static 'recovery_app/js/main.js' %}"></script>
{% endblock %}
